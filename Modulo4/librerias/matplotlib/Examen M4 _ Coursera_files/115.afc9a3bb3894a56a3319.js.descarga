(window.webpackJsonp=window.webpackJsonp||[]).push([[115],{"34Ts":function(module,e,t){"use strict";var n=t("BqYt"),r=t("Rc4f");e.a=function(e){var t=Object(r.a)(e).then(function(e){return new n.a(e.elements)});return t.done(),t}},"7KAE":function(module,e,t){"use strict";var n=t("VbXa"),r=t.n(n),a=t("q1tI"),s=t.n(a),o=t("17x9"),c=t.n(o),i=t("kvW3"),u=t("U6QN"),l=function(e){function WeeklyNewLearnerBanner(){return e.apply(this,arguments)||this}var t;return r()(WeeklyNewLearnerBanner,e),WeeklyNewLearnerBanner.prototype.render=function render(){var e=this.props.course,t=e.name,n="/teach/".concat(e.slug),r=u.a.getWeeklyNewLearnerCount(this.props.learnerCounts);return s.a.createElement("div",{className:"rc-WeeklyNewLearnerBanner"},s.a.createElement("a",{href:n},s.a.createElement("strong",{className:"c-teach-banner-learner-count"},s.a.createElement(i.c,{value:r})," learners"))," ","enrolled in ",s.a.createElement("span",{className:"c-teach-banner-course-name"},t)," in the past week. View more on the"," ",s.a.createElement("a",{href:n},s.a.createElement("strong",null,"Course Dashboard.")))},WeeklyNewLearnerBanner}(s.a.Component);l.propTypes={course:c.a.object.isRequired,learnerCounts:c.a.object.isRequired},e.a=l},BqYt:function(module,e,t){"use strict";var n=t("welz"),r=t.n(n),a=t("pWop"),s=r.a.Collection.extend({model:a.a,getEnrolled:function getEnrolled(){return this.filter(function(e){return e.get("courseRole")!==a.a.NOT_ENROLLED})}});e.a=s},EAIP:function(module,exports,e){var t=e("Pvx9"),n;"string"==typeof t&&(t=[[module.i,t,""]]);var r={transform:void 0},a=e("aET+")(t,r);t.locals&&(module.exports=t.locals)},Pvx9:function(module,exports,e){},Rc4f:function(module,e,t){"use strict";var n=t("S+eF"),r=t.n(n),a=t("fw5G"),s=t.n(a),o=t("TKYU");e.a=function(e){var t=(new s.a).addQueryParam("q","findByUser").addQueryParam("userId",e);return r()(o.a.get(t.toString()))}},U6QN:function(module,e,t){"use strict";var n=t("S+eF"),r=t.n(n),a=t("DnuM"),s=t("sQ/U"),o=t("hs7e"),c=t("34Ts"),i=t("rIRb"),u=Object(a.a)("/api/reports.v1",{type:"rest"}),l="teachVisitedAt",m=10080,d={getBannerData:function getBannerData(){var e=this;return this.getTeachingCourse().spread(function(t,n){return[t,n,e.getLearnerCounts(t,n)]})},getVisitedTimestamp:function getVisitedTimestamp(){return localStorage.teachVisitedAt},setVisitedTimestamp:function setVisitedTimestamp(){localStorage.teachVisitedAt=Date.now()},shouldShow:function shouldShow(){var e=this.getVisitedTimestamp();if(e){var t=new Date(parseInt(e)),n=new Date(Date.now()),r,a,s;return 60*n.getHours()+n.getMinutes()-(60*t.getHours()+t.getMinutes())>10080}return!0},getTeachingCourse:function getTeachingCourse(){var e=s.a.get().id;if(!e)return r.a.reject();return Object(c.a)(e).then(function(e){var t=e.find(function(e){return e.hasTeachingRole()});if(t&&"UNIVERSITY_ADMIN"!==t.get("courseRole")){var n=t.get("courseId");return[t,o.a.fromId(n)]}return r.a.reject()}).spread(function(e,t){return i.a.isLaunched(t)?[e,t]:r.a.reject()})},getLearnerCounts:function getLearnerCounts(e,t){var n=this;return r()(u.get("Course~".concat(t.id,"~activity_learner_counts"))).then(function(a){return n.validateLearnerCountsResponse(a)?a.elements[0].body:r.a.reject({membership:e,course:t})})},validateLearnerCountsResponse:function validateLearnerCountsResponse(e){return e.elements&&e.elements[0]&&e.elements[0].body&&e.elements[0].body.latest&&e.elements[0].body.latest.starter_ever_count&&e.elements[0].body.latest.active_learner_past_1w_count&&e.elements[0].body.latest.visitor_ever_count&&e.elements[0].body["1w_ago"]&&e.elements[0].body["1w_ago"].starter_ever_count},getWeeklyNewLearnerCount:function getWeeklyNewLearnerCount(e){return e.latest.starter_ever_count-e["1w_ago"].starter_ever_count},getWeeklyActiveLearnerCount:function getWeeklyActiveLearnerCount(e){return e.latest.active_learner_past_1w_count},getTotalLearnerCount:function getTotalLearnerCount(e){return e.latest.visitor_ever_count}};e.a=d;var h=d.getBannerData,p=d.getVisitedTimestamp,v=d.setVisitedTimestamp,f=d.shouldShow,g=d.getTeachingCourse,y=d.getLearnerCounts,b=d.validateLearnerCountsResponse,C=d.getWeeklyNewLearnerCount,w=d.getWeeklyActiveLearnerCount,L=d.getTotalLearnerCount},i2Qy:function(module,e,t){"use strict";var n=t("VbXa"),r=t.n(n),a=t("q1tI"),s=t.n(a),o=t("17x9"),c=t.n(o),i=t("kvW3"),u=t("U6QN"),l=function(e){function TotalLearnerBanner(){return e.apply(this,arguments)||this}var t;return r()(TotalLearnerBanner,e),TotalLearnerBanner.prototype.render=function render(){var e=this.props.course,t=e.name,n="/teach/".concat(e.slug),r=u.a.getTotalLearnerCount(this.props.learnerCounts);return s.a.createElement("div",{className:"rc-TotalLearnerBanner"},"A total of"," ",s.a.createElement("a",{href:n},s.a.createElement("strong",{className:"c-teach-banner-learner-count"},s.a.createElement(i.c,{value:r})," learners"))," ","are enrolled in ",s.a.createElement("span",{className:"c-teach-banner-course-name"},t),". View more on the"," ",s.a.createElement("a",{href:n},s.a.createElement("strong",null,"Course Dashboard.")))},TotalLearnerBanner}(s.a.Component);l.propTypes={course:c.a.object.isRequired,learnerCounts:c.a.object.isRequired},e.a=l},"jq+c":function(module,e,t){"use strict";t.r(e);var n=t("VbXa"),r=t.n(n),a=t("q1tI"),s=t.n(a),o=t("U6QN"),c=t("EAIP"),i=t.n(c),u=t("i2Qy"),l=t("xP36"),m=t("7KAE"),d=[{key:"weeklyActiveLearner",component:l.a},{key:"weeklyNewLearner",component:m.a},{key:"totalLearner",component:u.a}],h=function(e){function TeachBanner(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={course:null,membership:null,learnerCounts:{},bannerIndex:-1,dismissed:!1},t.handleDismiss=function(){o.a.setVisitedTimestamp(),t.setState({dismissed:!0})},t}r()(TeachBanner,e);var t=TeachBanner.prototype;return t.componentDidMount=function componentDidMount(){var e=this;o.a.getBannerData().spread(function(t,n,r){var a=Math.round(Math.random()*(d.length-1));e.setState({course:n,membership:t,learnerCounts:r,bannerIndex:a})}).catch(function(){}).done()},t.renderBanner=function renderBanner(){var e=d[this.state.bannerIndex].component;return s.a.createElement(e,{course:this.state.course,learnerCounts:this.state.learnerCounts})},t.render=function render(){if(!this.state.course||this.state.dismissed||!o.a.shouldShow())return s.a.createElement("div",null);return s.a.createElement("div",{className:"rc-TeachBanner bt3-alert bt3-alert-info bt3-alert-dismissable"},s.a.createElement("div",{className:"c-teach-banner-content"},s.a.createElement("button",{onClick:this.handleDismiss,className:"bt3-close","data-dismiss":"alert","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"Ã—")),this.renderBanner()))},TeachBanner}(s.a.Component);e.default=h},xP36:function(module,e,t){"use strict";var n=t("VbXa"),r=t.n(n),a=t("q1tI"),s=t.n(a),o=t("17x9"),c=t.n(o),i=t("kvW3"),u=t("U6QN"),l=function(e){function WeeklyActiveLearnerBanner(){return e.apply(this,arguments)||this}var t;return r()(WeeklyActiveLearnerBanner,e),WeeklyActiveLearnerBanner.prototype.render=function render(){var e=this.props.course,t=e.name,n="/teach/".concat(e.slug),r=u.a.getWeeklyActiveLearnerCount(this.props.learnerCounts);return s.a.createElement("div",{className:"rc-WeeklyActiveLearnerBanner"},s.a.createElement("a",{href:n},s.a.createElement("strong",{className:"c-teach-banner-learner-count"},s.a.createElement(i.c,{value:r})," learners"))," ","were active in ",s.a.createElement("span",{className:"c-teach-banner-course-name"},t)," in the past week. View more on the"," ",s.a.createElement("a",{href:n},s.a.createElement("strong",null,"Course Dashboard.")))},WeeklyActiveLearnerBanner}(s.a.Component);l.propTypes={course:c.a.object.isRequired,learnerCounts:c.a.object.isRequired},e.a=l}}]);
//# sourceMappingURL=115.afc9a3bb3894a56a3319.js.map